<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mac M芯片Pwn环境部署 | h4m0r's Blog</title>
<meta name=keywords content="Mac,Pwn"><meta name=description content="Mac M芯片Pwn环境部署"><meta name=author content="h4m0r"><link rel=canonical href=https://hamor.top/posts/tech/mac-m%E8%8A%AF%E7%89%87pwn%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/><meta name=google-site-verification content="GR1ffzitmVWrYRtzKiL6ro8CN0Fhrzg3HWvCapyY5EU"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://hamor.top/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://hamor.top/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://hamor.top/img/Q.gif><link rel=apple-touch-icon href=https://hamor.top/img/Q.gif><link rel=mask-icon href=https://hamor.top/img/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://hamor.top/posts/tech/mac-m%E8%8A%AF%E7%89%87pwn%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script defer src=https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GJCCZ7HKTC"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GJCCZ7HKTC")</script><meta property="og:title" content="Mac M芯片Pwn环境部署"><meta property="og:description" content="Mac M芯片Pwn环境部署"><meta property="og:type" content="article"><meta property="og:url" content="https://hamor.top/posts/tech/mac-m%E8%8A%AF%E7%89%87pwn%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"><meta property="og:image" content="https://hamor.top/posts/tech/img/pwn.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-24T14:43:56+08:00"><meta property="article:modified_time" content="2025-03-24T14:43:56+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hamor.top/posts/tech/img/pwn.png"><meta name=twitter:title content="Mac M芯片Pwn环境部署"><meta name=twitter:description content="Mac M芯片Pwn环境部署"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"文章","item":"https://hamor.top/posts/"},{"@type":"ListItem","position":2,"name":"技术","item":"https://hamor.top/posts/tech/"},{"@type":"ListItem","position":3,"name":"Mac M芯片Pwn环境部署","item":"https://hamor.top/posts/tech/mac-m%E8%8A%AF%E7%89%87pwn%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mac M芯片Pwn环境部署","name":"Mac M芯片Pwn环境部署","description":"Mac M芯片Pwn环境部署","keywords":["Mac","Pwn"],"articleBody":"背景 自从换了mac后，很多安全的环境需要重新搭建。Pwn的环境一直没有在本地去部署，受限于Mac M芯片arm架构的原因，直接在本地环境安装Pwn环境会有一些问题，在最近的二进制安全学习中，终于沉下心来把Pwn的环境部署完成。\n一、虚拟机选择 Pwn环境的最佳部署环境是X86的架构下部署，而现在的Mac都是arm架构的，所以这里选择用UTM虚拟机安装Ubuntu来模拟进行模拟。Pwntools官方文档说明在64位Ubuntu LTS 版本（22.04 和 24.04）上运行受到最佳的支持，为了更顺畅的运行，这里选择ubuntu server 22.04，桌面版不推荐。\nUTM：https://github.com/utmapp/UTM Ubuntu：https://releases.ubuntu.com/22.04/ubuntu-22.04.5-live-server-amd64.iso\n二、UTM安装Ubuntu 1、开始的时候这里选择CPU模拟 2、这里选择Linux 3、这里选择导入ubuntu镜像，然后一直下一步，直到完成。 4、然后启动并安装ubuntu\n0x01 全英文安装即可 0x02 DHCP自动获取IP 0x03 这里可以替换成国内的镜像源，安装完成后再替换也可以 0x04 这里是磁盘分区，默认给了多少就会显示多少 0x05 格式化警告，选择continue 0x06 创建用户名密码 0x07 这里选择SSH安装，方便后面通过ssh连接，空格勾选安装，然后点Done 0x08 然后一直Done下一步，直到系统完成安装。系统安装完成后，需要选择Reboot重启，重启时，要将镜像ISO推出。 0x09 等待重启完成后，根据安装过程中显示的IP，可以SSH登录到虚拟机，如果没注意，可以用以下命令进行查看。\nip addr 或者安装net-tools工具，通过ifconfig查看IP。\nsudo apt install net-tools 三、正式部署Pwn环境 1、安装pip sudo apt-get install python3-pip 2、安装必要的依赖 sudo apt install libssl-dev libffi-dev build-essential git vim 3、安装pwntools pip3 install pwntools -i https://pypi.tuna.tsinghua.edu.cn/simple 4、设置环境变量 pwntools安装完成后，会得到checksec和ROPgedget工具，但在运行checksec时，会提示没有找到，需要先设置一下环境变量，然后运行checksec就可以了。\n#查看当前环境变量 echo $PATH #在~/.bashrc内添加 export PATH=$PATH:/home/用户名/.local/bin source ~/.bashrc 5、安装gdb插件 mkdir tools cd tools 0x01 下载 peda git clone https://github.com/longld/peda.git 0x02 下载Pwngdb git clone https://github.com/scwuaptx/Pwngdb.git 0x03 下载安装pwndbg git clone https://github.com/pwndbg/pwndbg cd pwndbg/ ./setup.sh 0x04 配置插件 #tools目录下 cp Pwngdb/.gdbinit ~ vim ~/.gdbinit #打开文件后文件内容修改如下，注释掉第一行，然后添加source ～/tools/pwndgb/gdbinit.py #一定要在source ~/Pwngdb/angelheap/gdbinit.py前面，要不然会使用默认配置。| 0x05 测试gdb 6、安装seccomp-tools(查沙盒) sudo apt install gcc ruby-dev sudo gem install seccomp-tools 7、安装ropper pip3 install ropper 8、安装qemu(系统内核) sudo apt-get install qemu-user qemu-system 9、安装glibc-all-in-one git clone https://github.com/matrix1001/glibc-all-in-one.git cd glibc-all-in-one vim update_list 改为#!/usr/bin/python3 0x01 使用方法 #更新最新版本的glibc ./update_list #查看可下载的glibc cat list #根据题目所给的libc,找对应版本的连接器,并下载该连接器 ./download 2.23-0ubuntu11.3_amd64 #下载好的libc就在libs目录下 ls libs/2.23-0ubuntu11.3_amd64/ #把ld文件和libc复制到pwn题目录下 #一般来说使用时把标记的ld-2.23.so和libc-2.23.so拷贝在程序目录下即可 #.debug文件用于gdb调试 #在gdb设置setdebugf 10、安装patchelf sudo apt-get install patchelf 0x01 使用方法 #查看题目原来的libc和ld，“easyheap”为可执行程序 此处为例子 ldd easyheap #替换libc patchelf --replace-needed libc.so.6 ./libc-2.23.so ./easyheap #设置ld文件 patchelf --set-interpreter ./ld-2.23.so ./easyheap 11、安装one_gadget sudo gem install one_gadget 12、安装 zstd 预防报错（extract脚本在解压的时候用到了zstd解压命令）提前安装\nsudo apt-get install zstd 四、至此Mac上的Pwn环境部署完成 ","wordCount":"1598","inLanguage":"zh","image":"https://hamor.top/posts/tech/img/pwn.png","datePublished":"2025-03-24T14:43:56+08:00","dateModified":"2025-03-24T14:43:56+08:00","author":[{"@type":"Person","name":"h4m0r"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://hamor.top/posts/tech/mac-m%E8%8A%AF%E7%89%87pwn%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2/"},"publisher":{"@type":"Organization","name":"h4m0r's Blog","logo":{"@type":"ImageObject","url":"https://hamor.top/img/Q.gif"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hamor.top/ accesskey=h title="h4m0r's Blog (Alt + H)"><img src=https://hamor.top/img/Q.gif alt=logo aria-label=logo height=35>h4m0r's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://hamor.top/search title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li><li><a href=https://hamor.top/ title=主页><span>主页</span></a></li><li><a href=https://hamor.top/posts title=文章><span>文章</span></a></li><li><a href=https://hamor.top/tags title=标签><span>标签</span></a></li><li><a href=https://hamor.top/archives/ title=时间轴><span>时间轴</span></a></li><li><a href=https://hamor.top/about title=关于><span>关于</span></a></li><li><a href=https://hamor.top/links title=友链><span>友链</span></a></li></ul></nav></header><main class=main><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}</style><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://hamor.top/>🏠 主页</a>&nbsp;»&nbsp;<a href=https://hamor.top/posts/>文章</a>&nbsp;»&nbsp;<a href=https://hamor.top/posts/tech/>技术</a></div><h1 class=post-title>Mac M芯片Pwn环境部署</h1><div class=post-description>Mac M芯片Pwn环境部署</div><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span>
<span>2025-03-24
&nbsp;&nbsp;
</span></span><span id=post_meta_style_3><span class="fa fa-file-word-o"></span>
<span>1598字
&nbsp;&nbsp;
</span></span><span id=post_meta_style_4><span class="fa fa-clock-o"></span>
<span>4分钟
&nbsp;&nbsp;
</span></span><span id=post_meta_style_5><span class="fa fa-user-o"></span>
<span>h4m0r
&nbsp;&nbsp;
</span></span><span id=post_meta_style_6><span class="fa fa-tags" style=opacity:.8></span>
<span><span class=post-tags-meta><a href=https://hamor.top/tags/mac/ style=color:var(--secondary)!important>Mac</a>
&nbsp;<a href=https://hamor.top/tags/pwn/ style=color:var(--secondary)!important>Pwn</a>
</span></span></span></span><span style=opacity:.8><span id=post_meta_style_7>&nbsp;&nbsp;
<span class="fa fa-eye"></span>
<span><span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>
&nbsp;&nbsp;
</span></span><span id=post_meta_style_8><span class="fa fa-commenting-o"></span>
<span><script src=https://cdn.staticfile.org/twikoo/1.6.32/twikoo.all.min.js></script><script>let url=document.documentURI,dnsUrl="https://hamor.top/",urlSplit=url.split(dnsUrl),finalUrl=urlSplit[1];finalUrl[0]!=="/"&&(finalUrl="/"+finalUrl),twikoo.getCommentsCount({envId:"https://twikoo-api-sigma-brown.vercel.app/",region:null,urls:[finalUrl],includeReply:!1}).then(function(e){let t=e[0].count;const n=document.getElementById("comment_count");n.innerText=t}).catch(function(e){console.error(e)})</script><span id=comment_count></span></span></span></span></div></header><figure class=entry-cover1><img style=zoom: loading=lazy src=https://hamor.top/posts/tech/img/pwn.png alt></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e8%83%8c%e6%99%af aria-label=背景>背景</a></li><li><a href=#%e4%b8%80%e8%99%9a%e6%8b%9f%e6%9c%ba%e9%80%89%e6%8b%a9 aria-label=一、虚拟机选择>一、虚拟机选择</a></li><li><a href=#%e4%ba%8cutm%e5%ae%89%e8%a3%85ubuntu aria-label=二、UTM安装Ubuntu>二、UTM安装Ubuntu</a></li><li><a href=#%e4%b8%89%e6%ad%a3%e5%bc%8f%e9%83%a8%e7%bd%b2pwn%e7%8e%af%e5%a2%83 aria-label=三、正式部署Pwn环境>三、正式部署Pwn环境</a><ul><li><a href=#1%e5%ae%89%e8%a3%85pip aria-label=1、安装pip>1、安装pip</a></li><li><a href=#2%e5%ae%89%e8%a3%85%e5%bf%85%e8%a6%81%e7%9a%84%e4%be%9d%e8%b5%96 aria-label=2、安装必要的依赖>2、安装必要的依赖</a></li><li><a href=#3%e5%ae%89%e8%a3%85pwntools aria-label=3、安装pwntools>3、安装pwntools</a></li><li><a href=#4%e8%ae%be%e7%bd%ae%e7%8e%af%e5%a2%83%e5%8f%98%e9%87%8f aria-label=4、设置环境变量>4、设置环境变量</a></li><li><a href=#5%e5%ae%89%e8%a3%85gdb%e6%8f%92%e4%bb%b6 aria-label=5、安装gdb插件>5、安装gdb插件</a><ul><li><a href=#0x01-%e4%b8%8b%e8%bd%bd-peda aria-label="0x01 下载 peda">0x01 下载 peda</a></li><li><a href=#0x02-%e4%b8%8b%e8%bd%bdpwngdb aria-label="0x02 下载Pwngdb">0x02 下载Pwngdb</a></li><li><a href=#0x03-%e4%b8%8b%e8%bd%bd%e5%ae%89%e8%a3%85pwndbg aria-label="0x03 下载安装pwndbg">0x03 下载安装pwndbg</a></li><li><a href=#0x04-%e9%85%8d%e7%bd%ae%e6%8f%92%e4%bb%b6 aria-label="0x04 配置插件">0x04 配置插件</a></li><li><a href=#0x05-%e6%b5%8b%e8%af%95gdb aria-label="0x05 测试gdb">0x05 测试gdb</a></li></ul></li><li><a href=#6%e5%ae%89%e8%a3%85seccomp-tools%e6%9f%a5%e6%b2%99%e7%9b%92 aria-label=6、安装seccomp-tools(查沙盒)>6、安装seccomp-tools(查沙盒)</a></li><li><a href=#7%e5%ae%89%e8%a3%85ropper aria-label=7、安装ropper>7、安装ropper</a></li><li><a href=#8%e5%ae%89%e8%a3%85qemu%e7%b3%bb%e7%bb%9f%e5%86%85%e6%a0%b8 aria-label=8、安装qemu(系统内核)>8、安装qemu(系统内核)</a></li><li><a href=#9%e5%ae%89%e8%a3%85glibc-all-in-one aria-label=9、安装glibc-all-in-one>9、安装glibc-all-in-one</a><ul><li><a href=#0x01-%e4%bd%bf%e7%94%a8%e6%96%b9%e6%b3%95 aria-label="0x01 使用方法">0x01 使用方法</a></li></ul></li><li><a href=#10%e5%ae%89%e8%a3%85patchelf aria-label=10、安装patchelf>10、安装patchelf</a><ul><li><a href=#0x01-%e4%bd%bf%e7%94%a8%e6%96%b9%e6%b3%95-1 aria-label="0x01 使用方法">0x01 使用方法</a></li></ul></li><li><a href=#11%e5%ae%89%e8%a3%85one_gadget aria-label=11、安装one_gadget>11、安装one_gadget</a></li><li><a href=#12%e5%ae%89%e8%a3%85-zstd aria-label="12、安装 zstd">12、安装 zstd</a></li></ul></li><li><a href=#%e5%9b%9b%e8%87%b3%e6%ad%a4mac%e4%b8%8a%e7%9a%84pwn%e7%8e%af%e5%a2%83%e9%83%a8%e7%bd%b2%e5%ae%8c%e6%88%90 aria-label=四、至此Mac上的Pwn环境部署完成>四、至此Mac上的Pwn环境部署完成</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{elements&&(activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")}))},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=背景>背景<a hidden class=anchor aria-hidden=true href=#背景>#</a></h2><blockquote><p>自从换了mac后，很多安全的环境需要重新搭建。Pwn的环境一直没有在本地去部署，受限于Mac M芯片arm架构的原因，直接在本地环境安装Pwn环境会有一些问题，在最近的二进制安全学习中，终于沉下心来把Pwn的环境部署完成。</p></blockquote><h2 id=一虚拟机选择>一、虚拟机选择<a hidden class=anchor aria-hidden=true href=#一虚拟机选择>#</a></h2><p>Pwn环境的最佳部署环境是X86的架构下部署，而现在的Mac都是arm架构的，所以这里选择用UTM虚拟机安装Ubuntu来模拟进行模拟。Pwntools官方文档说明在64位Ubuntu LTS 版本（22.04 和 24.04）上运行受到最佳的支持，为了更顺畅的运行，这里选择ubuntu server 22.04，桌面版不推荐。</p><p>UTM：<a href=https://github.com/utmapp/UTM>https://github.com/utmapp/UTM</a>
Ubuntu：<a href=https://releases.ubuntu.com/22.04/ubuntu-22.04.5-live-server-amd64.iso>https://releases.ubuntu.com/22.04/ubuntu-22.04.5-live-server-amd64.iso</a></p><h2 id=二utm安装ubuntu>二、UTM安装Ubuntu<a hidden class=anchor aria-hidden=true href=#二utm安装ubuntu>#</a></h2><p>1、开始的时候这里选择CPU模拟
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309153144.png alt=image.png></p><p>2、这里选择Linux
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309153317.png alt=image.png></p><p>3、这里选择导入ubuntu镜像，然后一直下一步，直到完成。
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309153407.png alt=image.png></p><p>4、然后启动并安装ubuntu</p><p>0x01 全英文安装即可
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155102.png alt=image.png>
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155126.png alt=image.png>
0x02 DHCP自动获取IP
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155146.png alt=image.png>
0x03 这里可以替换成国内的镜像源，安装完成后再替换也可以
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155206.png alt=image.png>
0x04 这里是磁盘分区，默认给了多少就会显示多少
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155225.png alt=image.png>
0x05 格式化警告，选择continue
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155245.png alt=image.png>
0x06 创建用户名密码
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155726.png alt=image.png>
0x07 这里选择SSH安装，方便后面通过ssh连接，空格勾选安装，然后点Done
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309155757.png alt=image.png>
0x08 然后一直Done下一步，直到系统完成安装。系统安装完成后，需要选择Reboot重启，重启时，要将镜像ISO推出。
<img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309160109.png alt=image.png>
0x09 等待重启完成后，根据安装过程中显示的IP，可以SSH登录到虚拟机，如果没注意，可以用以下命令进行查看。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ip addr
</span></span></code></pre></div><p>或者安装net-tools工具，通过ifconfig查看IP。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install net-tools
</span></span></code></pre></div><h2 id=三正式部署pwn环境>三、正式部署Pwn环境<a hidden class=anchor aria-hidden=true href=#三正式部署pwn环境>#</a></h2><h3 id=1安装pip>1、安装pip<a hidden class=anchor aria-hidden=true href=#1安装pip>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get install python3-pip
</span></span></code></pre></div><h3 id=2安装必要的依赖>2、安装必要的依赖<a hidden class=anchor aria-hidden=true href=#2安装必要的依赖>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install libssl-dev libffi-dev build-essential git vim
</span></span></code></pre></div><h3 id=3安装pwntools>3、安装pwntools<a hidden class=anchor aria-hidden=true href=#3安装pwntools>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pip3 install pwntools -i https://pypi.tuna.tsinghua.edu.cn/simple
</span></span></code></pre></div><h3 id=4设置环境变量>4、设置环境变量<a hidden class=anchor aria-hidden=true href=#4设置环境变量>#</a></h3><p>pwntools安装完成后，会得到checksec和ROPgedget工具，但在运行checksec时，会提示没有找到，需要先设置一下环境变量，然后运行checksec就可以了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#查看当前环境变量</span>
</span></span><span style=display:flex><span>echo $PATH
</span></span><span style=display:flex><span><span style=color:#75715e>#在~/.bashrc内添加</span>
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$PATH:/home/用户名/.local/bin
</span></span><span style=display:flex><span>source ~/.bashrc
</span></span></code></pre></div><p><img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309161733.png alt=image.png></p><h3 id=5安装gdb插件>5、安装gdb插件<a hidden class=anchor aria-hidden=true href=#5安装gdb插件>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>mkdir tools
</span></span><span style=display:flex><span>cd tools
</span></span></code></pre></div><h4 id=0x01-下载-peda>0x01 下载 peda<a hidden class=anchor aria-hidden=true href=#0x01-下载-peda>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/longld/peda.git
</span></span></code></pre></div><h4 id=0x02-下载pwngdb>0x02 下载Pwngdb<a hidden class=anchor aria-hidden=true href=#0x02-下载pwngdb>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/scwuaptx/Pwngdb.git 
</span></span></code></pre></div><h4 id=0x03-下载安装pwndbg>0x03 下载安装pwndbg<a hidden class=anchor aria-hidden=true href=#0x03-下载安装pwndbg>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/pwndbg/pwndbg
</span></span><span style=display:flex><span>cd pwndbg/
</span></span><span style=display:flex><span>./setup.sh
</span></span></code></pre></div><h4 id=0x04-配置插件>0x04 配置插件<a hidden class=anchor aria-hidden=true href=#0x04-配置插件>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#tools目录下</span>
</span></span><span style=display:flex><span>cp Pwngdb/.gdbinit ~ 
</span></span><span style=display:flex><span>vim ~/.gdbinit
</span></span><span style=display:flex><span><span style=color:#75715e>#打开文件后文件内容修改如下，注释掉第一行，然后添加source ～/tools/pwndgb/gdbinit.py</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#一定要在source ~/Pwngdb/angelheap/gdbinit.py前面，要不然会使用默认配置。|</span>
</span></span></code></pre></div><p><img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309163203.png alt=image.png></p><h4 id=0x05-测试gdb>0x05 测试gdb<a hidden class=anchor aria-hidden=true href=#0x05-测试gdb>#</a></h4><p><img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309163459.png alt=image.png></p><h3 id=6安装seccomp-tools查沙盒>6、安装seccomp-tools(查沙盒)<a hidden class=anchor aria-hidden=true href=#6安装seccomp-tools查沙盒>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt install gcc ruby-dev
</span></span><span style=display:flex><span>sudo gem install seccomp-tools
</span></span></code></pre></div><p><img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309163920.png alt=image.png></p><h3 id=7安装ropper>7、安装ropper<a hidden class=anchor aria-hidden=true href=#7安装ropper>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pip3 install ropper
</span></span></code></pre></div><h3 id=8安装qemu系统内核>8、安装qemu(系统内核)<a hidden class=anchor aria-hidden=true href=#8安装qemu系统内核>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get install qemu-user qemu-system
</span></span></code></pre></div><h3 id=9安装glibc-all-in-one>9、安装glibc-all-in-one<a hidden class=anchor aria-hidden=true href=#9安装glibc-all-in-one>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/matrix1001/glibc-all-in-one.git  
</span></span><span style=display:flex><span>cd glibc-all-in-one  
</span></span><span style=display:flex><span>vim update_list  
</span></span><span style=display:flex><span>改为#!/usr/bin/python3
</span></span></code></pre></div><h4 id=0x01-使用方法>0x01 使用方法<a hidden class=anchor aria-hidden=true href=#0x01-使用方法>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#更新最新版本的glibc</span>
</span></span><span style=display:flex><span>./update_list
</span></span><span style=display:flex><span><span style=color:#75715e>#查看可下载的glibc</span>
</span></span><span style=display:flex><span>cat list
</span></span><span style=display:flex><span><span style=color:#75715e>#根据题目所给的libc,找对应版本的连接器,并下载该连接器</span>
</span></span><span style=display:flex><span>./download 2.23-0ubuntu11.3_amd64
</span></span><span style=display:flex><span><span style=color:#75715e>#下载好的libc就在libs目录下</span>
</span></span><span style=display:flex><span>ls libs/2.23-0ubuntu11.3_amd64/
</span></span><span style=display:flex><span><span style=color:#75715e>#把ld文件和libc复制到pwn题目录下</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#一般来说使用时把标记的ld-2.23.so和libc-2.23.so拷贝在程序目录下即可</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#.debug文件用于gdb调试</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#在gdb设置setdebugf</span>
</span></span></code></pre></div><h3 id=10安装patchelf>10、安装patchelf<a hidden class=anchor aria-hidden=true href=#10安装patchelf>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get install patchelf
</span></span></code></pre></div><h4 id=0x01-使用方法-1>0x01 使用方法<a hidden class=anchor aria-hidden=true href=#0x01-使用方法-1>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#查看题目原来的libc和ld，“easyheap”为可执行程序 此处为例子</span>
</span></span><span style=display:flex><span>ldd easyheap
</span></span><span style=display:flex><span><span style=color:#75715e>#替换libc</span>
</span></span><span style=display:flex><span>patchelf --replace-needed libc.so.6 ./libc-2.23.so ./easyheap
</span></span><span style=display:flex><span><span style=color:#75715e>#设置ld文件</span>
</span></span><span style=display:flex><span>patchelf --set-interpreter ./ld-2.23.so ./easyheap
</span></span></code></pre></div><h3 id=11安装one_gadget>11、安装one_gadget<a hidden class=anchor aria-hidden=true href=#11安装one_gadget>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo gem install one_gadget
</span></span></code></pre></div><p><img loading=lazy src=https://cdn.hamor.top/gh/h4m0r/Blog_img/cdnimg/20250309164807.png alt=image.png></p><h3 id=12安装-zstd>12、安装 zstd<a hidden class=anchor aria-hidden=true href=#12安装-zstd>#</a></h3><p>预防报错（extract脚本在解压的时候用到了zstd解压命令）提前安装</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get install zstd
</span></span></code></pre></div><h2 id=四至此mac上的pwn环境部署完成>四、至此Mac上的Pwn环境部署完成<a hidden class=anchor aria-hidden=true href=#四至此mac上的pwn环境部署完成>#</a></h2></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://hamor.top/img/wechat_pay.png alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://hamor.top/img/alipay.png alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>🧧 鼓励</span></button></div></div><footer class=post-footer><nav class=paginav><a class=next href=https://hamor.top/posts/read/%E5%A8%81%E8%81%94%E9%80%9Anas-docker%E9%83%A8%E7%BD%B2codimd%E5%8F%8A%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E4%BF%AE%E6%94%B9%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/><span class=title>下一页 »</span><br><span>威联通NAS Docker部署CodiMD及环境变量修改解决方案</span></a></nav></footer></div><style>.comments_details summary::marker{font-size:20px;content:'👉展开评论';color:var(--content)}.comments_details[open] summary::marker{font-size:20px;content:'👇关闭评论';color:var(--content)}</style><div><details class=comments_details><summary style="cursor:pointer;margin:50px 0 20px;width:130px"><span style=font-size:20px;color:var(--content)>...</span></summary><div id=tcomment></div></details><script src=https://cdn.staticfile.org/twikoo/1.6.32/twikoo.all.min.js></script><script>twikoo.init({envId:"https://twikoo-api-sigma-brown.vercel.app/",el:"#tcomment",lang:"zh-CN",region:null,path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><div class=ad-container><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4347970602668716" crossorigin=anonymous></script><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-4347970602668716 data-ad-slot=7275312215></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><span>Copyright
&copy;
2024-2025
<a href=https://hamor.top/ style=color:#939393>h4m0r's Blog</a>
Powered by Hugo & PaperMod
    </span><span id=busuanzi_container><span class="fa fa-user"></span> <span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye"></span> <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
<span id=read_progress></span>
</span></a><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{(function(){document.cookie="change-themes="+escape("false")})(),document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.body.addEventListener("copy",function(e){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let t=e.clipboardData||window.clipboardData;if(t){e.preventDefault();let n=window.getSelection().toString()+`\r

————————————————\r
版权声明：本文为「h4m0r's Blog」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\r
原文链接：`+location.href,s=window.getSelection().toString()+`\r

————————————————\r
版权声明：本文为「h4m0r's Blog」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\r
原文链接：`+location.href;t.setData("text/html",n),t.setData("text/plain",s)}}})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="复制";function i(){t.innerText="已复制！",setTimeout(()=>{t.innerText="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent+`\r
————————————————\r
版权声明：本文为「h4m0r's Blog」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\r
原文链接：`+location.href;navigator.clipboard.writeText(t),i();return}const n=document.createRange();n.selectNodeContents(e);const s=window.getSelection();s.removeAllRanges(),s.addRange(n);try{document.execCommand("copy"),i()}catch{}s.removeRange(n)});let l=e.className.replaceAll("language-",""),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),o=document.createElement("div");o.innerText=l,n.setAttribute("class","mac-tool"),a.setAttribute("class","mac bb1"),r.setAttribute("class","mac bb2"),c.setAttribute("class","mac bb3"),o.setAttribute("class","language-type"),n.appendChild(a),n.appendChild(r),n.appendChild(c),n.appendChild(o),s.classList.contains("highlight")?(s.appendChild(t),s.appendChild(n)):s.parentNode.firstChild==s||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?(e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t),s.appendChild(n)):(e.parentNode.appendChild(t),s.appendChild(n)))})</script></body></html>